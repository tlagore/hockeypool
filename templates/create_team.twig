{% extends 'base.twig' %}

{% block primary_content %}



<div class="row">
	<div class="col-lg-4">
		<input type="text" class="form-control" name="team_name"
			placeholder="Team Name">
	</div>
	<div class="col-lg-8 col-md-8 col-sm-8" style="text-align: right;">
		<p>
			Remaining allowed players: <span id="numRemaining">{{ num_players }}</span>
		</p>
	</div>
</div>
<br />


<div class="bs-component">
	<div class="onHover">
		<table id="rosterTable" class="table table-striped table-hover">
			<thead class="thead-inverse">
				<tr class="success" style="text-align: center">
					<th style="width:15%" class="onHover">Name</th>
					<th align="center">Team</th>
					<th align="center">Position</th>
					<th align="center">Games Played</th>
					<th align="center">Goals</th>
					<th align="center">Assists</th>
					<th align="center">+/-</th>
					<th align="center">Penalty Mins</th>
					<th align="center">Shots on Goal</th>
					<th align="center">PP goals</th>
					<th align="center">GW goals</th>
					<th>Pick</th>
				</tr>
			</thead>
			<tbody>
				{% for player in nhl_players %}
				<tr class="clickableRow" id="{{ player.name }}{{ player.team }}">
					<td align="center">{{ player.name }}</td>
					<td align="center">{{ player.team }}</td>
					<td align="center">{{ player.position }}</td>
					<td align="center">{{ player.games_played }}</td>
					<td align="center">{{ player.goals }}</td>
					<td align="center">{{ player.assists }}</td>
					<td align="center">{{ player.plus_minus }}</td>
					<td align="center">{{ player.penalty_mins }}</td>
					<td align="center">{{ player.shots_on_goal }}</td>
					<td align="center">{{ player.pp_goals }}</td>
					<td align="center">{{ player.gw_goals }}</td>
					<td><a href="#"><span
							id="{{ player.name }}{{ player.team }}span"
							style="color: #5cb85c;" class="glyphicon glyphicon-plus"></span></a>
						{# <td><input class="checkboxSelector" type="button"
						onclick='checkboxChanged(this);' value="add"></td> #}
				</tr>
				{% endfor %}
			</tbody>
		</table>
	</div>
</div>
<div class="bs-component">
	<div class="onHover">
		<table id="teamTable" class="table table-striped table-hover">
			<thead class="thead-inverse">
				<tr class="success">
					<th style="width:15%" class="onHover" align="center">Name</th>
					<th align="center">Team</th>
					<th align="center">Position</th>
					<th align="center">Games Played</th>
					<th align="center">Goals</th>
					<th align="center">Assists</th>
					<th align="center">+/-</th>
					<th align="center">Penalty Mins</th>
					<th align="center">Shots on Goal</th>
					<th align="center">PP goals</th>
					<th align="center">GW goals</th>
					<th>Pick</th>
				</tr>
			</thead>
			<tbody>
			</tbody>
		</table>
	</div>
</div>

{% endblock %}


{% block extra_scripts %}
<script type="text/javascript">
	$(document).ready(function() {
		var rosterTable = $('#rosterTable').DataTable();
		var teamTable = $('#teamTable').DataTable();

		rosterTable.on('click', 'tr', function() {
			var numPlayers = parseInt(document.getElementById('numRemaining').innerHTML);
			if(numPlayers > 0){
    			var $row = $(this);
    			var addRow = rosterTable.row(this);
    			teamTable.row.add(addRow.data()).draw();
    			addRow.remove().draw();
    			numPlayers--;
    			document.getElementById('numRemaining').innerHTML = numPlayers;
    			alert(row.id);
			}else{
				alert('You have used all your allowable players! Remove players to add more.');
			}
		});

		teamTable.on('click', 'tr', function() {
			var numPlayers = parseInt(document.getElementById('numRemaining').innerHTML);
			numPlayers += 1;
			var $row = $(this);
			var addRow = teamTable.row(this);
			rosterTable.row.add(addRow.data()).draw();
			addRow.remove().draw();
			//alert(numPlayers);
			document.getElementById('numRemaining').innerHTML = numPlayers;
			});
			/*
    			var $row = $(this);
    			var addRow = teamTable.row(this);
    			rosterTable.row.add(addRow.data()).draw();
    			addRow.remove().draw();
    			document.getElementById('numRemaining').innertHTML = parseInt(document.getElementById('numRemaining').innerHTML) + 1;
			}else{
				alert('You have used all your allowable players! Remove players to add more.');
			}*/
	});

	$('#rosterTable').on('page.dt', function() {
		//add logic to do stuff when page changes on roster table
	});

	$('#teamTable').on('page.dt', function() {
		//add logic to do stuff when page changes on roster table
	});

	function checkboxChanged(cb) {

		var num = document.getElementById("numRemaining").innerHTML;

		if (cb != null && cb.checked)
			num = parseInt(num) - 1;
		else if (cb != null)
			num = parseInt(num) + 1;

		if (num === 0) {
			var checkboxes = document
					.getElementsByClassName('checkboxSelector');
			for (var i = 0; i < checkboxes.length; i++) {
				if (!checkboxes[i].checked)
					checkboxes[i].disabled = true;
			}
		} else if (num === 1) {
			var checkboxes = document
					.getElementsByClassName('checkboxSelector');
			for (var i = 0; i < checkboxes.length; i++) {
				checkboxes[i].disabled = false;
			}
		}
		if (cb != null) {
			document.getElementById("numRemaining").innerHTML = num;
		}
		/*$('#mytable tr').filter(':has(:checkbox:checked)').each(function() {
			 $('#out').append(this.id);
			});*/
	}
</script>
{% endblock %}